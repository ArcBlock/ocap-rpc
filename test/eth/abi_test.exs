defmodule OcapRpcTest.Internal.EthABI do
  @moduledoc false

  use ExUnit.Case
  alias OcapRpc.Internal.EthABI

  @contract_create_tr %{
    action: %{
      from: "0x00c5e04176d95a286fcce0e68c683ca0bfec8454",
      gas: "0x173351",
      init:
        "0x606060405234156200001057600080fd5b604051620016d8380380620016d8833981016040528080519060200190919080518201919060200180519060200190919080518201919050505b83600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002081905550836003819055508260009080519060200190620000ad9291906200012e565b508060019080519060200190620000c69291906200012e565b5081600260006101000a81548160ff021916908360ff16021790555033600460006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b50505050620001dd565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106200017157805160ff1916838001178555620001a2565b82800160010185558215620001a2579182015b82811115620001a157825182559160200191906001019062000184565b5b509050620001b19190620001b5565b5090565b620001da91905b80821115620001d6576000816000905550600101620001bc565b5090565b90565b6114eb80620001ed6000396000f300606060405236156100d9576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806306fdde03146100e2578063095ea7b31461017157806318160ddd146101cb57806323b872dd146101f4578063313ce5671461026d5780633bed33ce1461029c57806342966c68146102bf5780636623fc46146102fa57806370a08231146103355780638da5cb5b1461038257806395d89b41146103d7578063a9059cbb14610466578063cd4217c1146104a8578063d7a78db8146104f5578063dd62ed3e14610530575b6100e05b5b565b005b34156100ed57600080fd5b6100f561059c565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156101365780820151818401525b60208101905061011a565b50505050905090810190601f1680156101635780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561017c57600080fd5b6101b1600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190803590602001909190505061063a565b604051808215151515815260200191505060405180910390f35b34156101d657600080fd5b6101de6106d6565b6040518082815260200191505060405180910390f35b34156101ff57600080fd5b610253600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190803573ffffffffffffffffffffffffffffffffffffffff169060200190919080359060200190919050506106dc565b604051808215151515815260200191505060405180910390f35b341561027857600080fd5b610280610b01565b604051808260ff1660ff16815260200191505060405180910390f35b34156102a757600080fd5b6102bd6004808035906020019091905050610b14565b005b34156102ca57600080fd5b6102e06004808035906020019091905050610bd6565b604051808215151515815260200191505060405180910390f35b341561030557600080fd5b61031b6004808035906020019091905050610d29565b604051808215151515815260200191505060405180910390f35b341561034057600080fd5b61036c600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050610ef6565b6040518082815260200191505060405180910390f35b341561038d57600080fd5b610395610f0e565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34156103e257600080fd5b6103ea610f34565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561042b5780820151818401525b60208101905061040f565b50505050905090810190601f1680156104585780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561047157600080fd5b6104a6600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050610fd2565b005b34156104b357600080fd5b6104df600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050611260565b6040518082815260200191505060405180910390f35b341561050057600080fd5b6105166004808035906020019091905050611278565b604051808215151515815260200191505060405180910390f35b341561053b57600080fd5b610586600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050611445565b6040518082815260200191505060405180910390f35b60008054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156106325780601f1061060757610100808354040283529160200191610632565b82019190600052602060",
      value: "0x0"
    },
    block_hash: "0x0706343ffeeb2112c164b9ebb87f9b037d2127c3283a7e7a7b9c20632544dad2",
    block_number: 3_978_343,
    result: %{
      address: "0xb8c77482e45f1f44de1745f52c74426c631bdd52",
      code:
        "0x606060405236156100d9576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806306fdde03146100e2578063095ea7b31461017157806318160ddd146101cb57806323b872dd146101f4578063313ce5671461026d5780633bed33ce1461029c57806342966c68146102bf5780636623fc46146102fa57806370a08231146103355780638da5cb5b1461038257806395d89b41146103d7578063a9059cbb14610466578063cd4217c1146104a8578063d7a78db8146104f5578063dd62ed3e14610530575b6100e05b5b565b005b34156100ed57600080fd5b6100f561059c565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156101365780820151818401525b60208101905061011a565b50505050905090810190601f1680156101635780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561017c57600080fd5b6101b1600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190803590602001909190505061063a565b604051808215151515815260200191505060405180910390f35b34156101d657600080fd5b6101de6106d6565b6040518082815260200191505060405180910390f35b34156101ff57600080fd5b610253600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190803573ffffffffffffffffffffffffffffffffffffffff169060200190919080359060200190919050506106dc565b604051808215151515815260200191505060405180910390f35b341561027857600080fd5b610280610b01565b604051808260ff1660ff16815260200191505060405180910390f35b34156102a757600080fd5b6102bd6004808035906020019091905050610b14565b005b34156102ca57600080fd5b6102e06004808035906020019091905050610bd6565b604051808215151515815260200191505060405180910390f35b341561030557600080fd5b61031b6004808035906020019091905050610d29565b604051808215151515815260200191505060405180910390f35b341561034057600080fd5b61036c600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050610ef6565b6040518082815260200191505060405180910390f35b341561038d57600080fd5b610395610f0e565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34156103e257600080fd5b6103ea610f34565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561042b5780820151818401525b60208101905061040f565b50505050905090810190601f1680156104585780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561047157600080fd5b6104a6600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050610fd2565b005b34156104b357600080fd5b6104df600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050611260565b6040518082815260200191505060405180910390f35b341561050057600080fd5b6105166004808035906020019091905050611278565b604051808215151515815260200191505060405180910390f35b341561053b57600080fd5b610586600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050611445565b6040518082815260200191505060405180910390f35b60008054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156106325780601f1061060757610100808354040283529160200191610632565b820191906000526020600020905b81548152906001019060200180831161061557829003601f168201915b505050505081565b6000808211151561064a57600080fd5b81600760003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002081905550600190505b92915050565b60035481565b6000808373ffffffffffffffffffffffffffffffffffffffff16141561070157600080fd5b60008211151561071057600080fd5b81600560008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054101561075c57600080fd5b600560008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205482600560008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020540110156107e957600080fd5b600760008573ffffffffffffffffffffffffffffff",
      gas_used: "0x123832"
    },
    subtraces: 0,
    trace_address: [],
    transaction_hash: "0x436fc7d21ed4a0a634f41b50ccb42fca12be7322de5bf9a20c97bdccbb5b2a04",
    transaction_position: 44,
    type: "create"
  }

  @contract_create_tx %{
    to_addr_code: "",
    r: "0x5056faa3a2b9e92bb2cc43810d19389cc81863bb365827f7e55c268133e64ed",
    from: "00c5e04176d95a286fcce0e68c683ca0bfec8454",
    public_key:
      "0xe2711ae8c7ec91d6f3b1ffcb87b6a77faf751bcf2c4e5fa0fe0545db99909d20aa9ab9d255ead28fede28521b28a095e15c4ef850c2672380bb5a43f7e1e08e2",
    s: "0x1f15e8a4bf68d309cb2332e9a753d4211228707c654a340c26dafcc09717c0c0",
    gas_price: 20_000_000_000,
    creates: "0xb8c77482e45f1f44de1745f52c74426c631bdd52",
    block_hash: "0706343ffeeb2112c164b9ebb87f9b037d2127c3283a7e7a7b9c20632544dad2",
    condition: nil,
    block_number: "0x3cb467",
    block_height: 3_978_343,
    gas_limit: 1_958_585,
    contract_address: "0xb8c77482e45f1f44de1745f52c74426c631bdd52",
    value: "0x0",
    cumulative_gas_used: 3_883_390,
    gas_used: 1_632_154,
    input:
      "606060405234156200001057600080fd5b604051620016d8380380620016d8833981016040528080519060200190919080518201919060200180519060200190919080518201919050505b83600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002081905550836003819055508260009080519060200190620000ad9291906200012e565b508060019080519060200190620000c69291906200012e565b5081600260006101000a81548160ff021916908360ff16021790555033600460006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b50505050620001dd565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106200017157805160ff1916838001178555620001a2565b82800160010185558215620001a2579182015b82811115620001a157825182559160200191906001019062000184565b5b509050620001b19190620001b5565b5090565b620001da91905b80821115620001d6576000816000905550600101620001bc565b5090565b90565b6114eb80620001ed6000396000f300606060405236156100d9576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806306fdde03146100e2578063095ea7b31461017157806318160ddd146101cb57806323b872dd146101f4578063313ce5671461026d5780633bed33ce1461029c57806342966c68146102bf5780636623fc46146102fa57806370a08231146103355780638da5cb5b1461038257806395d89b41146103d7578063a9059cbb14610466578063cd4217c1146104a8578063d7a78db8146104f5578063dd62ed3e14610530575b6100e05b5b565b005b34156100ed57600080fd5b6100f561059c565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156101365780820151818401525b60208101905061011a565b50505050905090810190601f1680156101635780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561017c57600080fd5b6101b1600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190803590602001909190505061063a565b604051808215151515815260200191505060405180910390f35b34156101d657600080fd5b6101de6106d6565b6040518082815260200191505060405180910390f35b34156101ff57600080fd5b610253600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190803573ffffffffffffffffffffffffffffffffffffffff169060200190919080359060200190919050506106dc565b604051808215151515815260200191505060405180910390f35b341561027857600080fd5b610280610b01565b604051808260ff1660ff16815260200191505060405180910390f35b34156102a757600080fd5b6102bd6004808035906020019091905050610b14565b005b34156102ca57600080fd5b6102e06004808035906020019091905050610bd6565b604051808215151515815260200191505060405180910390f35b341561030557600080fd5b61031b6004808035906020019091905050610d29565b604051808215151515815260200191505060405180910390f35b341561034057600080fd5b61036c600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050610ef6565b6040518082815260200191505060405180910390f35b341561038d57600080fd5b610395610f0e565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34156103e257600080fd5b6103ea610f34565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561042b5780820151818401525b60208101905061040f565b50505050905090810190601f1680156104585780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561047157600080fd5b6104a6600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050610fd2565b005b34156104b357600080fd5b6104df600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050611260565b6040518082815260200191505060405180910390f35b341561050057600080fd5b6105166004808035906020019091905050611278565b604051808215151515815260200191505060405180910390f35b341561053b57600080fd5b610586600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050611445565b6040518082815260200191505060405180910390f35b60008054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156106325780601f1061060757610100808354040283529160200191610632565b8201919060005260206000",
    standard_v: "0x0",
    to: nil,
    logs: [],
    raw:
      "0xf9182b808504a817c800831de2b98080b917d8606060405234156200001057600080fd5b604051620016d8380380620016d8833981016040528080519060200190919080518201919060200180519060200190919080518201919050505b83600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002081905550836003819055508260009080519060200190620000ad9291906200012e565b508060019080519060200190620000c69291906200012e565b5081600260006101000a81548160ff021916908360ff16021790555033600460006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b50505050620001dd565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106200017157805160ff1916838001178555620001a2565b82800160010185558215620001a2579182015b82811115620001a157825182559160200191906001019062000184565b5b509050620001b19190620001b5565b5090565b620001da91905b80821115620001d6576000816000905550600101620001bc565b5090565b90565b6114eb80620001ed6000396000f300606060405236156100d9576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806306fdde03146100e2578063095ea7b31461017157806318160ddd146101cb57806323b872dd146101f4578063313ce5671461026d5780633bed33ce1461029c57806342966c68146102bf5780636623fc46146102fa57806370a08231146103355780638da5cb5b1461038257806395d89b41146103d7578063a9059cbb14610466578063cd4217c1146104a8578063d7a78db8146104f5578063dd62ed3e14610530575b6100e05b5b565b005b34156100ed57600080fd5b6100f561059c565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156101365780820151818401525b60208101905061011a565b50505050905090810190601f1680156101635780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561017c57600080fd5b6101b1600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190803590602001909190505061063a565b604051808215151515815260200191505060405180910390f35b34156101d657600080fd5b6101de6106d6565b6040518082815260200191505060405180910390f35b34156101ff57600080fd5b610253600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190803573ffffffffffffffffffffffffffffffffffffffff169060200190919080359060200190919050506106dc565b604051808215151515815260200191505060405180910390f35b341561027857600080fd5b610280610b01565b604051808260ff1660ff16815260200191505060405180910390f35b34156102a757600080fd5b6102bd6004808035906020019091905050610b14565b005b34156102ca57600080fd5b6102e06004808035906020019091905050610bd6565b604051808215151515815260200191505060405180910390f35b341561030557600080fd5b61031b6004808035906020019091905050610d29565b604051808215151515815260200191505060405180910390f35b341561034057600080fd5b61036c600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050610ef6565b6040518082815260200191505060405180910390f35b341561038d57600080fd5b610395610f0e565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34156103e257600080fd5b6103ea610f34565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561042b5780820151818401525b60208101905061040f565b50505050905090810190601f1680156104585780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561047157600080fd5b6104a6600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050610fd2565b005b34156104b357600080fd5b6104df600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050611260565b6040518082815260200191505060405180910390f35b341561050057600080fd5b6105166004808035906020019091905050611278565b604051808215151515815260200191505060405180910390f35b341561053b57600080fd5b610586600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050611445565b6040518082815260200191505060405180910390f35b60008054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156106325780601f10610607576101008083540402835291",
    status: nil,
    root: "0xd5aacb11058647209447e1e9c7360289f47a144aad91097d237fdd897352110e",
    nonce: "0x0",
    hash: "436fc7d21ed4a0a634f41b50ccb42fca12be7322de5bf9a20c97bdccbb5b2a04",
    traces: [@contract_create_tr],
    timestamp: "0x595cf83c",
    logs_bloom:
      "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
    chain_id: "0x1",
    transaction_index: "0x2c",
    transaction_hash: "0x436fc7d21ed4a0a634f41b50ccb42fca12be7322de5bf9a20c97bdccbb5b2a04",
    v: "0x25",
    gas: "0x1de2b9"
  }

  @contract_execution_tx1 %{
    r: "0xd1c05cafc3184c21855a61d05bc863bcfc141b9cbdab62b66420decb02172454",
    from: "fd2d91100c786fcb1f3e8103ca1880a869828b1f",
    public_key:
      "0x28bab1404bf3006216d4eb3e184e426a27aed8538735d6296ee30b1a7c4531bddd15807ef5943729dfb9bb561ac91ff8d1e6c87508bb021d7bf46a80b1fc51ae",
    s: "0x323650b0af115fbaeb85db75fa2807c619ce4e94ff7eb4c5fc5d854324383a84",
    gas_price: 20_520_000_000,
    creates: nil,
    block_hash: "2de19874559948ded12b6497843940a185e14a28437cdabdf9d27ae8214530f8",
    condition: nil,
    chain_id: "0x1",
    block_number: "0x63b438",
    block_height: 6_534_200,
    gas_limit: 181_000,
    contract_address: nil,
    value: "0x0",
    cumulative_gas_used: 841_444,
    gas_used: 136_489,
    input:
      "722ded2400000000000000000000000000000000000000005bc7a98a000000000004b04200000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000008000000016683ee46ce9a5b59816f8f9e95a3bde6cea721deec1e64539c1cde030000000000005bc7a98f00000025f831c04000000000000046f7000000000087e6975d16f61d8771acb46d0d8d82e326bd79472862fa78a6ab475961e6bd8d1a06cf33e5d3896bdf8809c46f9fde81c51bdb26b2f525b78acee40a102ebcbc0d0000000000016683ee46dece40c836435d71f7df84adb65d045916e550b7d51b0000000000005bc7a98b00000025f831c04000000000000046f700010000008750057216079c3df361ec8835787d947f32d87c64039a44f47cca9117f645ac38364563acc99e29664fc231398bb6f7b568d63229258398a271182b6508d0c806",
    standard_v: "0x1",
    to: "7600977eb9effa627d6bd0da2e5be35e11566341",
    logs: [
      %{
        address: "0x7600977eb9effa627d6bd0da2e5be35e11566341",
        block_hash: "0x2de19874559948ded12b6497843940a185e14a28437cdabdf9d27ae8214530f8",
        block_number: "0x63b438",
        data:
          "0x0000000000000000000000009a5b59816f8f9e95a3bde6cea721deec1e64539c0000000000000000000000000000000000000000000000000000016683ee46ce000000000000000000000000ce40c836435d71f7df84adb65d045916e550b7d50000000000000000000000000000000000000000000000000000016683ee46de",
        log_index: "0xe",
        topics: ["0xf9f438e06428b6123b3c14646c5933b422676f1822e7b82e19f6d1333ebf640c"],
        transaction_hash: "0xabc7535985f4aaedd3b956d1df2e47d300e952e1f3dc295a0b64ef773a1a9124",
        transaction_index: "0xc",
        transaction_log_index: "0x0",
        type: "mined"
      }
    ],
    raw:
      "0xf901ce8302c69d8504c7165a008302c308947600977eb9effa627d6bd0da2e5be35e1156634180b90164722ded2400000000000000000000000000000000000000005bc7a98a000000000004b04200000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000008000000016683ee46ce9a5b59816f8f9e95a3bde6cea721deec1e64539c1cde030000000000005bc7a98f00000025f831c04000000000000046f7000000000087e6975d16f61d8771acb46d0d8d82e326bd79472862fa78a6ab475961e6bd8d1a06cf33e5d3896bdf8809c46f9fde81c51bdb26b2f525b78acee40a102ebcbc0d0000000000016683ee46dece40c836435d71f7df84adb65d045916e550b7d51b0000000000005bc7a98b00000025f831c04000000000000046f700010000008750057216079c3df361ec8835787d947f32d87c64039a44f47cca9117f645ac38364563acc99e29664fc231398bb6f7b568d63229258398a271182b6508d0c80626a0d1c05cafc3184c21855a61d05bc863bcfc141b9cbdab62b66420decb02172454a0323650b0af115fbaeb85db75fa2807c619ce4e94ff7eb4c5fc5d854324383a84",
    v: "0x26",
    status: "0x1",
    root: nil,
    nonce: "0x2c69d",
    hash: "abc7535985f4aaedd3b956d1df2e47d300e952e1f3dc295a0b64ef773a1a9124",
    traces: [
      %{
        action: %{
          call_type: "call",
          from: "0xfd2d91100c786fcb1f3e8103ca1880a869828b1f",
          gas: "0x233f0",
          input:
            "0x722ded2400000000000000000000000000000000000000005bc7a98a000000000004b04200000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000008000000016683ee46ce9a5b59816f8f9e95a3bde6cea721deec1e64539c1cde030000000000005bc7a98f00000025f831c04000000000000046f7000000000087e6975d16f61d8771acb46d0d8d82e326bd79472862fa78a6ab475961e6bd8d1a06cf33e5d3896bdf8809c46f9fde81c51bdb26b2f525b78acee40a102ebcbc0d0000000000016683ee46dece40c836435d71f7df84adb65d045916e550b7d51b0000000000005bc7a98b00000025f831c04000000000000046f700010000008750057216079c3df361ec8835787d947f32d87c64039a44f47cca9117f645ac38364563acc99e29664fc231398bb6f7b568d63229258398a271182b6508d0c806",
          to: "0x7600977eb9effa627d6bd0da2e5be35e11566341",
          value: "0x0"
        },
        block_hash: "0x2de19874559948ded12b6497843940a185e14a28437cdabdf9d27ae8214530f8",
        block_number: 6_534_200,
        result: %{gas_used: "0x18611", output: "0x"},
        subtraces: 0,
        trace_address: [],
        transaction_hash: "0xabc7535985f4aaedd3b956d1df2e47d300e952e1f3dc295a0b64ef773a1a9124",
        transaction_position: 12,
        type: "call"
      }
    ],
    receipt_status: 1,
    timestamp: "0x5bc7a997",
    logs_bloom:
      "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008080000000000000000000201000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
    transaction_index: "0xc",
    transaction_hash: "0xabc7535985f4aaedd3b956d1df2e47d300e952e1f3dc295a0b64ef773a1a9124",
    gas: "0x2c308"
  }

  @contract_execution_tr1 %{
    action: %{
      call_type: "call",
      from: "0xfd2d91100c786fcb1f3e8103ca1880a869828b1f",
      gas: "0x233f0",
      input:
        "0x722ded2400000000000000000000000000000000000000005bc7a98a000000000004b04200000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000008000000016683ee46ce9a5b59816f8f9e95a3bde6cea721deec1e64539c1cde030000000000005bc7a98f00000025f831c04000000000000046f7000000000087e6975d16f61d8771acb46d0d8d82e326bd79472862fa78a6ab475961e6bd8d1a06cf33e5d3896bdf8809c46f9fde81c51bdb26b2f525b78acee40a102ebcbc0d0000000000016683ee46dece40c836435d71f7df84adb65d045916e550b7d51b0000000000005bc7a98b00000025f831c04000000000000046f700010000008750057216079c3df361ec8835787d947f32d87c64039a44f47cca9117f645ac38364563acc99e29664fc231398bb6f7b568d63229258398a271182b6508d0c806",
      to: "0x7600977eb9effa627d6bd0da2e5be35e11566341",
      value: "0x0"
    },
    action_call_type: "call",
    action_from: "fd2d91100c786fcb1f3e8103ca1880a869828b1f",
    action_gas_limit: 144_368,
    action_input:
      "722ded2400000000000000000000000000000000000000005bc7a98a000000000004b04200000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000008000000016683ee46ce9a5b59816f8f9e95a3bde6cea721deec1e64539c1cde030000000000005bc7a98f00000025f831c04000000000000046f7000000000087e6975d16f61d8771acb46d0d8d82e326bd79472862fa78a6ab475961e6bd8d1a06cf33e5d3896bdf8809c46f9fde81c51bdb26b2f525b78acee40a102ebcbc0d0000000000016683ee46dece40c836435d71f7df84adb65d045916e550b7d51b0000000000005bc7a98b00000025f831c04000000000000046f700010000008750057216079c3df361ec8835787d947f32d87c64039a44f47cca9117f645ac38364563acc99e29664fc231398bb6f7b568d63229258398a271182b6508d0c806",
    action_to: "7600977eb9effa627d6bd0da2e5be35e11566341",
    action_value: 0,
    receipt_status: 1,
    block_hash: "2de19874559948ded12b6497843940a185e14a28437cdabdf9d27ae8214530f8",
    block_height: 6_534_200,
    block_number: 6_534_200,
    result: %{gas_used: "0x18611", output: "0x"},
    sub_traces: 0,
    subtraces: 0,
    trace_address: [-1],
    transaction_hash: "abc7535985f4aaedd3b956d1df2e47d300e952e1f3dc295a0b64ef773a1a9124",
    transaction_index: 12,
    transaction_position: 12,
    type: "call"
  }

  @contract_execution_tx2 %{
    logs_bloom:
      "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
    input:
      "6488733400000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000063b43400000000000000000000000000000000000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000003caadc507120d29de120509e40064000000000000000000000000000000000000bd3500d11e9a1df838c61be71eb10000000000000000000000000000000000003600ee2aab1559dbf5ee13bf0fff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003465c4b01eef4d828effbf81d00e000000000000000000000000000000000000047dd002ee275e606cb49e91be454000000000000000000000000000000000000cf000cda63f1b3250c19ed46fe010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002",
    public_key:
      "0x74bd5d97dabc3942c4c3941180f383ca583773069440ab516b0b57e8a5e2e64a7434e63f62e441d70b7cef1e3b1909580ecf7a6ab73b638815c479b7792b1c32",
    nonce: "0x2cacd",
    cumulative_gas_used: 5_515_844,
    to: "798abda6cc246d0edba912092a2a3dbd3d11191b",
    gas_limit: 98224,
    transaction_index: "0x45",
    block_hash: "2de19874559948ded12b6497843940a185e14a28437cdabdf9d27ae8214530f8",
    s: "0x1a9731a8b32d5b94b7f6efb27e7c35c938d8fa599f0a7476eea603c2e64f7ebc",
    block_number: "0x63b438",
    condition: nil,
    from: "8bc3da587def887b5c822105729ee1d6af05a5ca",
    block_height: 6_534_200,
    gas_price: 1_700_000_000,
    raw:
      "0xf9026d8302cacd846553f10083017fb094798abda6cc246d0edba912092a2a3dbd3d11191b80b902046488733400000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000063b43400000000000000000000000000000000000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000003caadc507120d29de120509e40064000000000000000000000000000000000000bd3500d11e9a1df838c61be71eb10000000000000000000000000000000000003600ee2aab1559dbf5ee13bf0fff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003465c4b01eef4d828effbf81d00e000000000000000000000000000000000000047dd002ee275e606cb49e91be454000000000000000000000000000000000000cf000cda63f1b3250c19ed46fe0100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000021ca0712a85ca55ff387729865a10bb0731da95f97b029dd501bdb68168f5b59e377aa01a9731a8b32d5b94b7f6efb27e7c35c938d8fa599f0a7476eea603c2e64f7ebc",
    value: "0x0",
    creates: nil,
    receipt_status: 1,
    timestamp: "0x5bc7a997",
    r: "0x712a85ca55ff387729865a10bb0731da95f97b029dd501bdb68168f5b59e377a",
    hash: "5d631f98a95bdee7da9977700060c9cd04faf0664fd3a4f4d082aa2cb3ef98fd",
    contract_address: nil,
    logs: [],
    status: "0x1",
    root: nil,
    v: "0x1c",
    gas_used: 48224,
    standard_v: "0x1",
    traces: [
      %{
        action: %{
          call_type: "call",
          from: "0x8bc3da587def887b5c822105729ee1d6af05a5ca",
          gas: "0x10e18",
          input:
            "0x6488733400000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000063b43400000000000000000000000000000000000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000003caadc507120d29de120509e40064000000000000000000000000000000000000bd3500d11e9a1df838c61be71eb10000000000000000000000000000000000003600ee2aab1559dbf5ee13bf0fff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003465c4b01eef4d828effbf81d00e000000000000000000000000000000000000047dd002ee275e606cb49e91be454000000000000000000000000000000000000cf000cda63f1b3250c19ed46fe010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002",
          to: "0x798abda6cc246d0edba912092a2a3dbd3d11191b",
          value: "0x0"
        },
        block_hash: "0x2de19874559948ded12b6497843940a185e14a28437cdabdf9d27ae8214530f8",
        block_number: 6_534_200,
        result: %{gas_used: "0x4ac8", output: "0x"},
        status: "0x1",
        subtraces: 0,
        trace_address: [],
        transaction_hash: "0x5d631f98a95bdee7da9977700060c9cd04faf0664fd3a4f4d082aa2cb3ef98fd",
        transaction_position: 69,
        type: "call"
      }
    ],
    chain_id: nil,
    gas: "0x17fb0",
    transaction_hash: "0x5d631f98a95bdee7da9977700060c9cd04faf0664fd3a4f4d082aa2cb3ef98fd"
  }

  @contract_execution_tr2 %{
    action: %{
      call_type: "call",
      from: "0x8bc3da587def887b5c822105729ee1d6af05a5ca",
      gas: "0x10e18",
      input:
        "0x6488733400000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000063b43400000000000000000000000000000000000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000003caadc507120d29de120509e40064000000000000000000000000000000000000bd3500d11e9a1df838c61be71eb10000000000000000000000000000000000003600ee2aab1559dbf5ee13bf0fff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003465c4b01eef4d828effbf81d00e000000000000000000000000000000000000047dd002ee275e606cb49e91be454000000000000000000000000000000000000cf000cda63f1b3250c19ed46fe010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002",
      to: "0x798abda6cc246d0edba912092a2a3dbd3d11191b",
      value: "0x0"
    },
    action_call_type: "call",
    action_from: "8bc3da587def887b5c822105729ee1d6af05a5ca",
    action_gas_limit: 69_144,
    action_input:
      "6488733400000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000063b43400000000000000000000000000000000000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000003caadc507120d29de120509e40064000000000000000000000000000000000000bd3500d11e9a1df838c61be71eb10000000000000000000000000000000000003600ee2aab1559dbf5ee13bf0fff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003465c4b01eef4d828effbf81d00e000000000000000000000000000000000000047dd002ee275e606cb49e91be454000000000000000000000000000000000000cf000cda63f1b3250c19ed46fe010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002",
    action_to: "798abda6cc246d0edba912092a2a3dbd3d11191b",
    action_value: 0,
    receipt_status: 1,
    block_hash: "2de19874559948ded12b6497843940a185e14a28437cdabdf9d27ae8214530f8",
    block_height: 6_534_200,
    block_number: 6_534_200,
    result: %{gas_used: "0x4ac8", output: "0x"},
    sub_traces: 0,
    subtraces: 0,
    trace_address: [-1],
    transaction_hash: "5d631f98a95bdee7da9977700060c9cd04faf0664fd3a4f4d082aa2cb3ef98fd",
    transaction_index: 69,
    transaction_position: 69,
    type: "call"
  }

  @input_with_bytes %{
    input:
      "0x150b7a02000000000000000000000000b814167b298ab9cca1ecb7a039cc2d54aa2b78b6000000000000000000000000b814167b298ab9cca1ecb7a039cc2d54aa2b78b600000000000000000000000000000002ffffffffffffffffffffffffffffff9e0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000001c3",
    receipt_status: 1
  }

  @input_with_signed_integer_array %{
    input:
      "881eeaa500000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000160000000000000000000000000b814167b298ab9cca1ecb7a039cc2d54aa2b78b6000000000000000000000000000000000000000000000000000000000000024000000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000006ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff9effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff9fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff9fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff9effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff9dffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff9d000000000000000000000000000000000000000000000000000000000000000f302c226b616e6734222c22222c22220000000000000000000000000000000000",
    receipt_status: 1
  }

  @succeeded_input_with_extra_data %{
    input:
      "a9059cbb00000000000000000000000063825c174ab367968ec60f061753d3bbd36a0d8f0000000000000000000000000000000000000000000002413aaf407a6760000000000000000000000000000000000000000000000000000000000000",
    receipt_status: 1
  }

  @failed_input_with_extra_data %{
    input:
      "a9059cbb00000000000000000000000063825c174ab367968ec60f061753d3bbd36a0d8f0000000000000000000000000000000000000000000002413aaf407a6760000000000000000000000000000000000000000000000000000000000000",
    receipt_status: 0
  }

  test "Contract deployment transaction" do
    assert nil == EthABI.parse_input(@contract_create_tx)
  end

  test "Contract deployment trace" do
    assert nil == EthABI.parse_input(@contract_create_tr)
  end

  test "Contract execution transaction 1" do
    assert {
             "exeSequence(uint256,uint256[])",
             [
               28_404_512_757_431_999_601_681_150_018,
               [
                 37_756_073_587_313_287_202_718_002_150_715_277_485_672_307_822_244_595_934_859_471_150_595,
                 147_484_662_837_531_463_245_424_893_683_123_005_078_216_254_221_594_653_228_007_559,
                 104_299_391_562_380_854_868_066_768_520_047_092_738_603_223_234_556_778_302_872_853_601_503_290_428_698,
                 3_079_972_619_077_622_401_367_245_919_595_582_169_901_016_282_484_934_100_496_153_725_015_810_685_965,
                 576_111_962_703_103_282_647_486_701_025_039_376_202_205_895_366_691_441_251_702_043,
                 147_484_662_454_407_578_028_952_679_093_536_248_290_638_958_316_909_876_977_074_311,
                 36_194_649_514_989_024_063_472_629_537_901_123_837_386_590_298_449_292_474_595_467_931_200_759_639_096,
                 24_547_494_202_198_087_088_699_800_983_634_951_769_428_531_290_438_987_877_942_964_536_388_906_698_758
               ]
             ]
           } == EthABI.parse_input(@contract_execution_tx1)
  end

  test "Contract execution trace 1" do
    assert {
             "exeSequence(uint256,uint256[])",
             [
               28_404_512_757_431_999_601_681_150_018,
               [
                 37_756_073_587_313_287_202_718_002_150_715_277_485_672_307_822_244_595_934_859_471_150_595,
                 147_484_662_837_531_463_245_424_893_683_123_005_078_216_254_221_594_653_228_007_559,
                 104_299_391_562_380_854_868_066_768_520_047_092_738_603_223_234_556_778_302_872_853_601_503_290_428_698,
                 3_079_972_619_077_622_401_367_245_919_595_582_169_901_016_282_484_934_100_496_153_725_015_810_685_965,
                 576_111_962_703_103_282_647_486_701_025_039_376_202_205_895_366_691_441_251_702_043,
                 147_484_662_454_407_578_028_952_679_093_536_248_290_638_958_316_909_876_977_074_311,
                 36_194_649_514_989_024_063_472_629_537_901_123_837_386_590_298_449_292_474_595_467_931_200_759_639_096,
                 24_547_494_202_198_087_088_699_800_983_634_951_769_428_531_290_438_987_877_942_964_536_388_906_698_758
               ]
             ]
           } == EthABI.parse_input(@contract_execution_tr1)
  end

  test "Contract execution transaction 2" do
    assert {"setCompactData(bytes14[],bytes14[],uint256,uint256[])",
            [
              [
                "0xcaadc507120d29de120509e40064",
                "0xbd3500d11e9a1df838c61be71eb1",
                "0x3600ee2aab1559dbf5ee13bf0fff"
              ],
              [
                "0x465c4b01eef4d828effbf81d00e0",
                "0x47dd002ee275e606cb49e91be454",
                "0xcf000cda63f1b3250c19ed46fe01"
              ],
              6_534_196,
              [1, 0, 2]
            ]} == EthABI.parse_input(@contract_execution_tx2)
  end

  test "Contract execution trace 2" do
    assert {"setCompactData(bytes14[],bytes14[],uint256,uint256[])",
            [
              [
                "0xcaadc507120d29de120509e40064",
                "0xbd3500d11e9a1df838c61be71eb1",
                "0x3600ee2aab1559dbf5ee13bf0fff"
              ],
              [
                "0x465c4b01eef4d828effbf81d00e0",
                "0x47dd002ee275e606cb49e91be454",
                "0xcf000cda63f1b3250c19ed46fe01"
              ],
              6_534_196,
              [1, 0, 2]
            ]} == EthABI.parse_input(@contract_execution_tr2)
  end

  test "input_with_bytes" do
    assert {"onERC721Received(address,address,uint256,bytes)",
            [
              "0xb814167b298ab9cca1ecb7a039cc2d54aa2b78b6",
              "0xb814167b298ab9cca1ecb7a039cc2d54aa2b78b6",
              1_020_847_100_762_815_390_390_123_822_295_304_634_270,
              "0x00000000000000000000000000000000000000000000000000000000000001c3"
            ]} == EthABI.parse_input(@input_with_bytes)
  end

  test "input_with_signed_integer_array" do
    assert {"createEstateWithMetadata(int256[],int256[],address,string)",
            [
              [2, 2, 3, 3, 3, 2],
              [-98, -97, -97, -98, -99, -99],
              "0xb814167b298ab9cca1ecb7a039cc2d54aa2b78b6",
              "0,\"kang4\",\"\",\"\""
            ]} == EthABI.parse_input(@input_with_signed_integer_array)
  end

  test "succeeded_input_with_extra_data" do
    assert {
             "transfer(address,uint256)",
             ["0x63825c174ab367968ec60f061753d3bbd36a0d8f", 10_648_000_000_000_000_000_000]
           } == EthABI.parse_input(@succeeded_input_with_extra_data)
  end

  test "failed_input_with_extra_data" do
    assert nil == EthABI.parse_input(@failed_input_with_extra_data)
  end
end
